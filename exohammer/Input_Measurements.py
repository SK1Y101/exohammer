#!/usr/bin/env python
# coding: utf-8

# In[1]:

from astropy import constants as const

mearth = const.M_earth.cgs.value #grams
msun   = const.M_sun.cgs.value

mstar  = 1.034 



measured = [[2455030.145908, 2455043.95822 , 2455057.653172, 2455071.596735,
       2455085.38127 , 2455099.264417, 2455113.185062, 2455126.92793 ,
       2455140.770799, 2455168.423202, 2455196.175606, 2455210.063613,
       2455223.940509, 2455237.764627, 2455251.647079, 2455265.49967 ,
       2455279.43351 , 2455293.318046, 2455307.202581, 2455321.07531 ,
       2455334.919568, 2455348.776324, 2455362.588637, 2455376.50095 ,
       2455404.131825, 2455417.997611, 2455473.228112, 2455487.175842,
       2455500.964543, 2455514.8088  , 2455528.635697, 2455542.452176,
       2455570.119857, 2455583.923836, 2455597.813927, 2455611.625546,
       2455625.514941, 2455653.16179 , 2455667.090074, 2455680.989888,
       2455694.834145, 2455708.845763, 2455722.57752 , 2455736.445388,
       2455750.363256, 2455764.242237, 2455778.031632, 2455791.993945,
       2455805.725008, 2455819.641487, 2455847.305697, 2455861.177037,
       2455875.031017, 2455888.843329, 2455902.65842 , 2455916.404066,
       2455930.403879, 2455944.137719, 2455957.950727, 2455971.744984,
       2455985.604519, 2455999.409887, 2456054.826499, 2456068.682563,
       2456082.576125, 2456096.365521, 2456110.329223, 2456151.891162,
       2456165.736807, 2456179.740788, 2456193.452406, 2456207.302912,
       2456221.241615, 2456235.095594, 2456262.723692, 2456276.604754,
       2456290.485817, 2456331.9672  , 2456345.819791, 2456359.516826,
       2456373.473583, 2456387.257424, 2456401.154458],
           [2454955.917878,2454972.152271, 2454988.406663, 2455004.642792, 
       2455020.892532, 2455037.141229, 2455053.392914, 2455069.647723,
       2455085.882879, 2455102.129216, 2455118.373053, 2455134.611334,
       2455150.863088, 2455167.1013  , 2455199.525363, 2455215.748505,
       2455248.185276, 2455264.399113, 2455280.577672, 2455296.801926,
       2455313.028887, 2455329.250502, 2455345.471839, 2455361.690328,
       2455377.896249, 2455394.138488, 2455410.387117, 2455426.637343,
       2455442.87868 , 2455459.128142, 2455475.372811, 2455491.62026 ,
       2455507.874791, 2455540.371215, 2455572.852361, 2455589.095226,
       2455605.326771, 2455621.561649, 2455654.005851, 2455670.22573 ,
       2455686.436163, 2455702.657431, 2455718.875573, 2455735.096633,
       2455751.280469, 2455767.508195, 2455783.735921, 2455799.956424,
       2455816.195053, 2455832.427987, 2455848.63863 , 2455864.890939,
       2455881.146443, 2455913.643143, 2455929.896564, 2455946.135609,
       2455962.383613, 2455978.633561, 2456011.136373, 2456027.371461,
       2456043.610367, 2456059.831078, 2456076.058874, 2456092.290072,
       2456108.517381, 2456140.934569, 2456157.151669, 2456173.382868,
       2456189.593302, 2456221.998267, 2456254.473302, 2456270.702486,
       2456286.946948, 2456303.183771, 2456335.660195, 2456351.906046,
       2456368.160994, 2456384.398788, 2456400.659292]]

epoch= [[  5,   6,   7,   8,   9,  10,  11,  12,  13,  15,  17,  18,  19,
        20,  21,  22,  23,  24,  25,  26,  27,  28,  29,  30,  32,  33,
        37,  38,  39,  40,  41,  42,  44,  45,  46,  47,  48,  50,  51,
        52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  64,  65,
        66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  79,  80,  81,
        82,  83,  86,  87,  88,  89,  90,  91,  92,  94,  95,  96,  99,
       100, 101, 102, 103, 104],
        [ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 15, 16, 18,
       19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36,
       38, 39, 40, 41, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55,
       56, 57, 59, 60, 61, 62, 63, 65, 66, 67, 68, 69, 70, 71, 73, 74, 75,
       76, 78, 80, 81, 82, 83, 85, 86, 87, 88, 89]]

error=[[0.01666667, 0.01597222, 0.03333333, 0.02916667, 0.02708333,
       0.025     , 0.01527778, 0.02152778, 0.00902778, 0.03194444,
       0.02013889, 0.03055556, 0.02152778, 0.02152778, 0.01805556,
       0.01597222, 0.02222222, 0.02152778, 0.01805556, 0.01388889,
       0.02361111, 0.025     , 0.03333333, 0.02013889, 0.02986111,
       0.01041667, 0.01666667, 0.02361111, 0.02916667, 0.0125    ,
       0.02222222, 0.02430556, 0.00833333, 0.02361111, 0.03055556,
       0.01875   , 0.01597222, 0.03125   , 0.03680556, 0.01527778,
       0.01736111, 0.01319444, 0.01180556, 0.02708333, 0.02152778,
       0.01944444, 0.02222222, 0.02222222, 0.02222222, 0.02291667,
       0.02222222, 0.02222222, 0.02152778, 0.01597222, 0.03333333,
       0.02291667, 0.02638889, 0.02152778, 0.01319444, 0.02916667,
       0.02986111, 0.01458333, 0.01875   , 0.01527778, 0.01736111,
       0.025     , 0.01944444, 0.02013889, 0.02083333, 0.02708333,
       0.01736111, 0.01458333, 0.01875   , 0.02361111, 0.02916667,
       0.04027778, 0.01388889, 0.0125    , 0.02152778, 0.02152778,
       0.03055556, 0.03402778, 0.0125    ],
       [0.00402778, 0.00256945, 0.00444445, 0.00319445, 0.00361111,
       0.00340278, 0.00270833, 0.00263889, 0.00263889, 0.00298611,
       0.003125  , 0.00347222, 0.00284722, 0.00354167, 0.00291667,
       0.00319444, 0.00291667, 0.00388889, 0.00333333, 0.00284722,
       0.00361111, 0.00243056, 0.00326389, 0.00368056, 0.00298611,
       0.00340278, 0.00347222, 0.003125  , 0.00263889, 0.00298611,
       0.00319444, 0.00305556, 0.00347222, 0.00305556, 0.00347222,
       0.003125  , 0.00319444, 0.00381944, 0.00347222, 0.003125  ,
       0.00305556, 0.00256944, 0.00326389, 0.00388889, 0.00333333,
       0.00305556, 0.00270833, 0.00354167, 0.00395833, 0.00291667,
       0.003125  , 0.003125  , 0.00333333, 0.003125  , 0.00326389,
       0.00375   , 0.00326389, 0.00305556, 0.00305556, 0.00340278,
       0.00333333, 0.00291667, 0.00263889, 0.003125  , 0.00298611,
       0.00340278, 0.003125  , 0.003125  , 0.00298611, 0.00284722,
       0.00361111, 0.00284722, 0.00319444, 0.00333333, 0.00277778,
       0.00354167, 0.003125  , 0.00361111, 0.00347222]]

ttv_holczer = [[0.00069444, -0.15347222, -0.05902778, -0.12361111,
       -0.08958333, -0.01805556, -0.12430556, -0.13055556, -0.17638889,
       -0.12222222, -0.08333333, -0.05555556, -0.08055556, -0.04722222,
       -0.04375   ,  0.04097222,  0.07638889,  0.11180556,  0.13541667,
        0.13055556,  0.13819444,  0.10138889,  0.16458333,  0.09722222,
        0.11388889, -0.05208333,  0.04652778, -0.01388889, -0.01875   ,
       -0.04097222, -0.07361111, -0.10416667, -0.14930556, -0.10833333,
       -0.14583333, -0.10555556, -0.15694444, -112/60/24, -0.07777778, -0.02708333,
       -0.03194444,  0.13055556,  0.01319444,  0.03194444,  0.10069444,
        0.13055556,  0.07083333,  0.18402778,  0.06597222,  0.13333333,
        0.09930556,  0.12152778,  0.12638889,  0.08958333,  0.05555556,
       -0.04791667,  0.10277778, -0.0125    , -0.04861111, -0.10347222,
       -0.09305556, -0.13680556, -0.11666667, -0.10972222, -0.06527778,
       -0.125     , -0.01041667,  0.00416667,  0.00069444,  0.15555556,
        0.01805556,  0.01944444,  0.10902778,  0.11388889,  0.04375   ,
        0.07569444,  0.10763889,  0.04166667,  0.04513889, -0.10694444,
        0.00069444, -0.06458333, -0.01666667],
        [-0.05979167, -0.05729167, -0.03479167, -0.03055556, -0.01270833,
         0.00409722,  0.02388889,  0.04680556,  0.05006944,  0.06451389,
        0.07645833,  0.08284722,  0.10270833,  0.10902778,  0.06930556,
        0.06055556,  0.03354167,  0.01548611, -0.03784722, -0.04548611,
       -0.05041667, -0.06069444, -0.07125   , -0.08465278, -0.110625  ,
       -0.10027778, -0.08354167, -0.06520833, -0.05576389, -0.03819444,
       -0.02541667, -0.00986111,  0.01277778,  0.04541667,  0.06277778,
        0.07375   ,  0.07340278,  0.07638889,  0.05680556,  0.04479167,
        0.02333333,  0.01270833, -0.00104167, -0.011875  , -0.05993056,
       -0.06409722, -0.06826389, -0.07965278, -0.07291667, -0.071875  ,
       -0.093125  , -0.07270833, -0.04909722, -0.01618056,  0.00534722,
        0.0125    ,  0.02861111,  0.04666667,  0.08569444,  0.08888889,
        0.09590278,  0.08472222,  0.080625  ,  0.07993056,  0.07534722,
        0.02875   ,  0.01395833,  0.01326389, -0.00819444, -0.06701389,
       -0.05576389, -0.05847222, -0.04590278, -0.04097222, -0.02833333,
       -0.014375  ,  0.00868056,  0.01458333,  0.04319444]]


# In[ ]:

orbital_elements = {'mass_b'         : [mearth/msun,  10 * mearth/msun ],   
                    'period_b'       : [13.849-.05,   13.849+.05       ],                
                    'eccentricity_b' : [0.00,         0.04             ],
                    'inclination_b'  : [89.5,         90.5             ],
                    'longnode_b'     : [-45.0,        45.0             ],
                    'argument_b'     : [0.0,          360.0            ],
                    'mean_anomaly_b' : [0.0,          360.0            ],
     
                    'mass_c'         : [mearth/msun,  10 * mearth/msun ],   
                    'period_c'       : [16.2369-.05,  16.2369+.05      ],                
                    'eccentricity_c' : [0.00,         0.04             ],
                    'inclination_c'  : [89.5,         90.5             ],
                    'longnode_c'     : [0.0                            ],
                    'argument_c'     : [0.0,          360.0            ],
                    'mean_anomaly_c' : [0.0,          360.0            ]}

x=[mstar, epoch, measured, error, orbital_elements]

donghong_elements = [4.6813098187, 13.8365700314, 0.0250513232, 90.4221451464, 0.3013433398, 83.1024519679, 209.2594293527], [7.9316353360, 16.2369403451, 0.0061762733, 90.2377925833, 0.0000000000, 247.5376924170, 165.7005024527]

#mass, period, eccentricity, inclination, longnode, argument, mean_anomaly

orbital_elements = {'mass_b'         : [mearth/msun,  10 * mearth/msun ],   
                    'period_b'       : [13.849-.05,   13.849+.05       ],                
                    'eccentricity_b' : [0.00,         0.04             ],
                    'inclination_b'  : [89.5,         90.5             ],
                    'longnode_b'     : [-45.0,        45.0             ],
                    'argument_b'     : [0.0,          360.0            ],
                    'mean_anomaly_b' : [0.0,          360.0            ],
     
                    'mass_c'         : [mearth/msun,  10 * mearth/msun ],   
                    'period_c'       : [16.2369-.05,  16.2369+.05      ],                
                    'eccentricity_c' : [0.00,         0.04             ],
                    'inclination_c'  : [89.5,         90.5             ],
                    'longnode_c'     : [0.0                            ],
                    'argument_c'     : [0.0,          360.0            ],
                    'mean_anomaly_c' : [0.0,          360.0            ],
                    
                    
                    'mass_d'         : [mearth/msun,  100 * mearth/msun],   
                    'period_d'       : [165.,         175.      ],                
                    'eccentricity_d' : [0.00,         0.04             ],
                    'inclination_d'  : [0,            180             ],
                    'longnode_d'     : [-45.0,        45.0             ],
                    'argument_d'     : [0.0,          360.0            ],
                    'mean_anomaly_d' : [0.0,          360.0            ]}



# In[ ]:
    
    
rv = [[2456138.960111, #BJD
2456202.74719,
2456880.986613,
2456892.948262,
2456909.872368,
2456912.827319,
2457151.077157,
2457180.097595,
2457208.096426,
2457232.984981,
2457243.082964,
2458294.878483,
2458322.919588,
2458329.871325,
2458337.067316,
2458383.960506,
2458391.919851,
2458395.857491,
2458723.006589],
[11.9236788815611, #MNVEL
-16.1134940581337,
-4.06925772245635,
-6.54617470079044,
-5.7705062430896,
-1.8848456824408,
7.81277266544407,
0.0602771570512033,
8.25316787388147,
-6.29082298836888,
-15.3491948450888,
7.00556500279268,
-2.28990086574453,
10.7279022469152,
-9.31859521574567,
0.983863725849822,
7.25795239603468,
7.04186679076109,
4.2862555505861],
[3.18929839134216, #ERRVEL
4.51967430114746,
3.90615701675415,
3.28753995895386,
3.43545699119568,
3.58018112182617,
3.54026436805725,
3.5506637096405,
3.62212514877319,
3.50754976272583,
4.02697372436523,
3.27114105224609,
4.85352230072021,
3.48017978668213,
3.79149770736694,
4.11460399627686,
3.638827085495,
3.71935081481934,
3.51347351074219]]
    
    
    
    
    
    
    
    
    
    